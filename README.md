# 简简单单画图扩展 (JJDD-Huatu)

![版本](https://img.shields.io/badge/版本-1.0.0-blue)
![许可证](https://img.shields.io/badge/许可证-AGPL--3.0-green)

## 简介 📝

简简单单画图扩展（JJDD-Huatu）是一款专为SillyTavern（酒馆）设计的强大AI画图工具，完美适配手机和电脑端，为您提供便捷易用的AI绘图体验。

### 核心优势 ✨

- **零部署**：无需自己配置SD或调试复杂接口，小白也能轻松使用
- **多平台**：完美适配手机和电脑端酒馆
- **资源丰富**：支持大量模型（包括FLUX、SD3等）和LORA
- **高清支持**：内置高清修复功能，一键提升画质
- **体验优化**：设计直观，操作简便，特别适合手机和低配置设备用户
- **图片缓存**：图片下载至本地永久显示，可重复向酒馆提供3天的缓存

## 安装方法 🔧

### 方法一：直接在SillyTavern中安装

1. 在SillyTavern中，进入"扩展"菜单
2. 点击"从URL安装"
3. 输入本仓库地址：`https://github.com/Writer-z/jjdd-huatu-st`
4. 点击安装

### 方法二：手动安装

1. 下载本仓库的ZIP文件
2. 解压到SillyTavern的`/extensions`目录下
3. 重启SillyTavern

## 配置与使用 🛠️

1. 在酒馆中导入扩展后，点击"使用技巧"标签页中的"点击设置"按钮
2. 输入您的API密钥并点击保存
3. 在termux上安装画图扩展后端程序并启动
4. 完成画图参数设置后，点击"测试按钮"可以验证密钥正确性和服务器连接是否成功

## 功能详解 🚀

### 1. 生成参数

基本绘图参数设置，包括：

- **模型选择**：提供包括FLUX、SD3等多种基础模型
  - 支持预设模型和自定义模型ID
  - 精选模型如FLUX-kg_09、FLUX-XIZ、SD3-Mccc等

- **尺寸设置**：调整图像宽度和高度
  - 默认为512×512像素
  - 支持自定义分辨率(最高2300*3200)

- **生成数量**：单次可生成1-4张图像

- **步数控制**：设置生成步数（默认20步）

- **CFG Scale**：控制提示词遵循度，默认值为7

- **种子值**：为图像生成设置随机种子，-1为随机

- **VAE选择**：支持多种VAE模型
  - ae.sft
  - vae-ft-mse
  - kl-f8-anime2
  - None

- **采样器**：多种采样算法可选
  - Euler
  - Euler a
  - DPM++ 2M
  - DPM++ SDE
  - UniPC

- **Clip Skip**：控制文本编码器跳过层数

### 2. Lora功能

强大的Lora模型支持，可以大幅提升画质和特定风格表现：

- **多Lora组合**：同时支持最多20个Lora模型
- **权重调整**：每个Lora可单独设置0-2之间的权重
- **快速保存**：将常用Lora保存至记事本功能

### 3. 提示词编辑

完善的提示词编辑功能：

- **正向提示词**：设置您希望在图像中看到的元素
- **负向提示词**：设置您希望避免出现的元素

### 4. 出图设置

图像显示与交互方式设置：

- **图片显示模式**：
  - 添加新消息：即生成图片以角色新消息方式发送
  - 替换当前消息：生成图片在原有消息最末尾显示
  - 更新按钮背景：生成图片替换按钮背景灵活显示

- **图片最大高度**：控制第二种模式图片在聊天消息中的显示比例
  - 40%、60%、80%、100%

- **按钮尺寸**：自定义生成按钮的尺寸

### 5. 记事本功能

便捷的内容记录与复用系统：

- **"+N"按钮**：快速保存常用模型ID、Lora到记事本
- **"+M"按钮**：把记事本保存的模型快速应用到模型选择输入框里
- **"+L"按钮**：把记事本保存的LORA快速应用到lora输入框里
- **"+P"按钮**：把记事本保存的触发词快速应用到正提示词输入框
- **分类管理**：预留说明输入框，方便自行记录

### 6. 高清修复

一键提升图像质量：

- **启用开关**：控制是否对生成图像进行高清修复
- **修复模型**：多种修复模型可选
  - R-ESRGAN 4x+
  - 4x-UltraSharp
  - None
  - Latent

- **修复尺寸**：自定义修复后的图像尺寸
- **修复步数**：控制修复过程的精细度
- **噪声强度**：调整修复过程中的细节保留程度

### 7. 工作流（开发中）

未来将支持工作流功能，敬请期待。

### 8. 体力系统

合理的资源消耗计量：

- **初始体力**：每个API密钥初始10000点体力值
- **消耗规则**：
  - 支持作图前测预估体力消耗 
  - 普通的sd画图仅消耗4-6点体力
  - 实际画图消耗体力与画图任务消耗服务器GPU相关
  - 可以简单理解：图片分辨率越高、迭代步数越高、高清修复分辨率越高、高清修复步数越高所消耗的体力值越多；画图的基础模型类型也有影响：FLUX比普通sd消耗的体力值更多

## 快捷命令 ⌨️

扩展支持便捷的斜杠命令：

- **/qx** 或 **/QX**：快速取消正在进行的画图任务，在画图任务未进入running状态可以取消并不且消耗体力值，进入running状态后无法取消直至完成本次画图任务

## 使用技巧 💡

1. **模型选择**：(注意模型选择模式只能二选一)
   - 关闭自定义模型开关：支持已设置好的初始模型通过下拉菜单选择
   - 打开自定义模型开关：支持在线网站模型，有大量的模型/lora供选择
   - 在线模型调用方法：
     1. 确保有魔法的网络环境，打开网址：https://tensor.art/
     2. 可以自行选择是否注册登录（邮箱验证），登录可以打开设置中的成人模式，使用绅士模型和lora
     3. 找到喜欢模型和lora，点开页面并复制网址(如：https://tensor.art/models/772139385270444718/Prefect-Pony-XL-v3),粘贴填入模型输入框即可

2. **Lora组合**：
   - 美术风格Lora权重建议设为0.6-0.8
   - 角色Lora权重建议设为0.8-1.0
   - 多个Lora叠加时注意与符合模型类型，如选用sd基底模型则lora必须相应匹配选择sd的lora，模型与lora不匹配会报错无法画图

3. **高清修复**：
   - 4x-UltraSharp适合细节丰富的图像
   - 修复时噪声强度建议0.3-0.5，值越小保留原图细节越多

4. **提示词技巧**：
   - 正向提示词中前置重要元素：可以放自己喜欢的质量提示词、lora触发词
   - 负向提示词中添加常见缺陷如"模糊"、"畸形"等

## 注意事项 ⚠️

1. 使用API密钥需支持作者获取，每个密钥拥有10000点初始体力
2. 请勿倒卖本扩展和服务
3. 画图扩展会持续免费更新

## 技术支持 📞

如有问题，请通过以下方式联系开发者：
- QQ: 2313643367
- 爱发电: https://afdian.com/a/jjdd-huatu

## 许可证 📄

本项目采用 [GNU Affero General Public License v3.0](LICENSE) 许可证。

## 致谢 🙏

感谢所有为本项目提供支持和反馈的用户。
